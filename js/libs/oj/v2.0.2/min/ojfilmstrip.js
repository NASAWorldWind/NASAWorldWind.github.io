/**
 * Copyright (c) 2014, 2016, Oracle and/or its affiliates.
 * The Universal Permissive License (UPL), Version 1.0
 */
"use strict";
define(["ojs/ojcore","jquery","ojs/ojcomponentcore","promise"],function(a,f){a.Id=function(){this.Init()};a.b.ga(a.Id,a.Pg,"oj.FilmStripPagingModel");a.Id.prototype.Init=function(){a.Id.r.Init.call(this);this.Kc=-1;this.Rd=0;this.Ja=-1};a.b.g("FilmStripPagingModel.prototype.Init",{Init:a.Id.prototype.Init});a.Id.prototype.Hqa=function(a){this.Rd=a};a.Id.prototype.getPage=function(){return this.Kc};a.b.g("FilmStripPagingModel.prototype.getPage",{getPage:a.Id.prototype.getPage});a.Id.prototype.setPage=
function(a,d){a=parseInt(a,10);try{var c=this.getPageCount(),e=this.Kc,f=this.Ja,h=f;d&&d.pageSize&&(h=d.pageSize);if(0===this.Rd&&-1===h)return Promise.resolve();var k=Math.ceil(this.Rd/h);if(0>a||a>k-1)throw Error("JET FilmStrip: Invalid 'page' set: "+a);var l=!1;if(a!=e||h!=f){if(!1===this.handleEvent("beforePage",{page:a,previousPage:e}))return Promise.reject();l=!0}this.Kc=a;this.Ja=h;var m=this.getPageCount(),n=this;return new Promise(function(d){c!=m&&n.handleEvent("pageCount",{pageCount:m,
previousPageCount:c});l&&n.handleEvent("page",{page:a,previousPage:e});d(null)})}catch(p){return Promise.reject(p)}};a.b.g("FilmStripPagingModel.prototype.setPage",{setPage:a.Id.prototype.setPage});a.Id.prototype.getStartItemIndex=function(){return-1===this.Kc&&-1===this.Ja?-1:this.Kc*this.Ja};a.b.g("FilmStripPagingModel.prototype.getStartItemIndex",{getStartItemIndex:a.Id.prototype.getStartItemIndex});a.Id.prototype.getEndItemIndex=function(){return Math.min(this.getStartItemIndex()+this.Ja,this.Rd)-
1};a.b.g("FilmStripPagingModel.prototype.getEndItemIndex",{getEndItemIndex:a.Id.prototype.getEndItemIndex});a.Id.prototype.getPageCount=function(){return Math.ceil(this.Rd/this.Ja)};a.b.g("FilmStripPagingModel.prototype.getPageCount",{getPageCount:a.Id.prototype.getPageCount});a.Id.prototype.totalSize=function(){return this.Rd};a.b.g("FilmStripPagingModel.prototype.totalSize",{totalSize:a.Id.prototype.totalSize});a.Id.prototype.totalSizeConfidence=function(){return"actual"};a.b.g("FilmStripPagingModel.prototype.totalSizeConfidence",
{totalSizeConfidence:a.Id.prototype.totalSizeConfidence});(function(){function b(a){var b=f("\x3cdiv\x3e\x3c/div\x3e");b.text(a);return b[0].innerHTML}function d(a){a.css("-webkit-transform",p).css("-ms-transform",p).css("transform",p)}function c(a,b){a.css("-webkit-transform",b).css("-ms-transform",b).css("transform",b)}a.ya("oj.ojFilmStrip",f.oj.baseComponent,{defaultElement:"\x3cdiv\x3e",widgetEventPrefix:"oj",options:{maxItemsPerPage:0,orientation:"horizontal",currentItem:0,arrowPlacement:"adjacent",
arrowVisibility:"auto"},_ComponentCreate:function(){this._super();var b=this.element;b.addClass("oj-filmstrip oj-component").attr("tabindex",0).attr("role","region");b.uniqueId();b=this.options;b.disabled&&a.q.warn(da);if(b.orientation!==w&&b.orientation!==fa)throw Error(s+b.orientation);if(b.arrowPlacement!==e&&b.arrowPlacement!==Y)throw Error(q+b.arrowPlacement);if(b.arrowVisibility!==ba&&b.arrowVisibility!==x&&b.arrowVisibility!==y&&b.arrowVisibility!==h)throw Error(t+b.arrowVisibility);this.rz=
this.eventNamespace+"Touch";this.DE=this.eventNamespace+"Mouse";this.p4=this.eventNamespace+"Key";this.LO=this.eventNamespace+"NavArrowHoverable";this.Ba(!0)},refresh:function(){this._super();this.Ba(!1)},getItemsPerPage:function(){return this.Fq},getPagingModel:function(){return this.Pd},Al:function(){this._super();this.Yc&&this.Ba(this.Yc[0])},wn:function(){this._super();this.Yc&&this.Ba(this.Yc[0])},Ba:function(b){b&&!this.Pd&&(this.Pd=new a.Id);if(this.hw()){this.Yc=null;this.Cf="rtl"===this.dc();
this.In=a.v.Ud();var c=this.element,d=this;b?(this.Fq=0,this.XJ=function(a){d.WJ(a)},this.Nn=0,this.kx=-1,this.Ak=function(){d.zq()},this.eh=function(){d.af()},this.In&&(this.MX=function(a){d.eK(a)},this.LX=function(a){d.dK(a)},this.cK=function(a){d.bK(a)},this.P$()),this.BX=function(a){d.gga(a)},this.CX=function(a){d.hga(a)},this.EX=function(a){d.jga(a)},this.L$(),this.AX=function(a){d.xq(a)},this.J$()):this.aV();for(var e=c.children(),f=0;f<e.length;f++)a.Components.Lg(e[f]);f=this.Pd;if(b)f.on("page",
this.XJ);f.Hqa(e.length);this.dna();if(0<e.length){this.jT();for(f=0;f<e.length;f++)a.Components.gf(e[f]);a.v.Ph(c[0],this.eh)}}else c=!1,this.Yc&&(c=this.Yc[0]),this.Yc=[b||c]},_destroy:function(){this.In&&(this.zka(),this.cK=this.LX=this.MX=null);this.ska();this.EX=this.CX=this.BX=null;this.qka();this.AX=null;this.aV();this.Pd.off("page",this.XJ);this.Ak=this.eh=this.Pd=this.XJ=null;var a=this.element;a.removeClass("oj-filmstrip oj-component "+L).removeAttr("tabindex role");a.removeUniqueId();this._super()},
aV:function(){a.v.Si(this.element[0],this.eh);this.kx=-1;this.Jx&&(clearTimeout(this.Jx),this.Jx=null);for(var b=this.PB(),c=0;c<b.length;c++)a.Components.Lg(b[c]);this.ZT();this.fJ().unwrap();this.Mma();for(c=0;c<b.length;c++)a.Components.gf(b[c])},_setOption:function(b,c,d){var f=this.options,g=!1,k=-1,l=this.Pd,m=l.getPage();switch(b){case "disabled":a.q.warn(da);break;case "orientation":if(c!==w&&c!==fa)throw Error(s+c);g=f.orientation!=c;break;case "maxItemsPerPage":g=f.maxItemsPerPage!=c;break;
case "arrowPlacement":if(c!==e&&c!==Y)throw Error(q+c);g=f.arrowPlacement!=c;break;case "arrowVisibility":if(c!==ba&&c!==x&&c!==y&&c!==h)throw Error(t+c);g=f.arrowVisibility!=c;break;case C:if(f.currentItem!=c&&(k=this.HI(c),0>k||k>=l.getPageCount()))throw Error(r+c);}this._super(b,c,d);switch(b){case C:-1<k&&k!=m&&l.setPage(k)}g&&this.Ba(!1)},af:function(){if(!this.wT)this.wT=!0,this.jT(!0),this.wT=!1;else if(!this.Jx){var a=this;this.Jx=setTimeout(function(){a.Jx=null;a.af()},0)}},Lb:function(){return this.options.orientation!==
fa},Iw:function(){return this.Lb()?this.Cf?"right":"left":"top"},kq:function(){return this.Lb()?"width":"height"},hw:function(){var a=document.createElement("div"),b=a.style;b.position="absolute";b.width="10px";b.height="10px";b=this.element[0];b.appendChild(a);var c=!1;try{c=0<a.offsetWidth&&0<a.offsetHeight}catch(d){}b.removeChild(a);return c},dna:function(){var a=this.element,b=this.Lb(),c=a.children();c.addClass(A).wrap("\x3cdiv class\x3d'"+z+" "+P+"'\x3e\x3c/div\x3e");var d=this.Iw();this.zj=
d=a.children().wrapAll("\x3cdiv class\x3d'"+z+" "+K+"' style\x3d'"+d+": 0px;'\x3e\x3c/div\x3e").parent();var f=this.options;f.arrowVisibility!==x&&f.arrowPlacement===e&&(this.UH=d.wrap("\x3cdiv class\x3d'"+z+" oj-filmstrip-content-container'\x3e\x3c/div\x3e").parent());a.addClass(z);b||a.addClass(Q);f.arrowVisibility!==x&&0<c.length&&(this.Hk=this.$ba(),this.yj=this.Mba(),this.NK()&&this.Qla())},Mma:function(){var a=this.element,b=this.PB();this.oma();this.Hk&&(this.Qp(this.Hk),this.Hk=null);this.yj&&
(this.Qp(this.yj),this.yj=null);var c=a.children(T+E);c&&c.remove();b.removeClass(A).unwrap().unwrap();this.zj=null;this.UH&&(b.unwrap(),this.UH=null);a.removeClass(z+" "+Q)},Qla:function(){this.element.on("mouseenter"+this.LO,function(a){f(a.currentTarget).hasClass("oj-disabled")||f(a.currentTarget).addClass(L)}).on("mouseleave"+this.LO,function(a){f(a.currentTarget).removeClass(L)})},oma:function(){this.element.off(this.LO)},NK:function(){var a=this.options,b=a.arrowVisibility;return b===y||b===
h&&a.arrowPlacement===Y},Dga:function(){return 0<this.Pd.getPage()},Cga:function(){var a=this.Pd;return a.getPage()<a.getPageCount()-1},nja:function(){if(this.Dga()){var a=this.Pd;a.setPage(a.getPage()-1)}},Mia:function(){if(this.Cga()){var a=this.Pd;a.setPage(a.getPage()+1)}},iV:function(a,b){this.options.arrowPlacement===e?b.css("visibility",a?"":x):b.parent().css("display",a?"":J)},Wma:function(){if(this.options.arrowVisibility!==x){var a=this.Pd,b=a.getPage(),a=a.getPageCount();this.iV(0!==b,
this.Hk);this.iV(b!==a-1,this.yj)}},$ba:function(){var a=this.element,c=this.Lb()?V:ga,d=this.zU(c);this.options.arrowPlacement===Y?a.append(d):a.prepend(d);var a=b(this.A("labelAccArrowPreviousPage")),e=b(this.A("tipArrowPreviousPage")),c=this.yU(d,c,a,e),f=this;c.on("click",function(){f.nja()});return c},Mba:function(){var a=this.element,c=this.Lb()?F:H,d=this.zU(c);a.append(d);var a=b(this.A("labelAccArrowNextPage")),e=b(this.A("tipArrowNextPage")),c=this.yU(d,c,a,e),f=this;c.on("click",function(){f.Mia()});
return c},zU:function(a){var b=f(document.createElement("div"));b.addClass(E+" "+a);this.options.arrowPlacement===Y&&(b.addClass("oj-filmstrip-arrow-container-overlay"),this.NK()&&b.addClass(B));return b},yU:function(a,b,c,d){var f="\x3cdiv class\x3d'"+G+" oj-default oj-enabled "+b+"' role\x3d'button' tabindex\x3d'-1'";a.append(f+("\x3e\x3cspan class\x3d'oj-filmstrip-arrow-icon "+b+" oj-component-icon'\x3e\x3c/span\x3e\x3c/div\x3e"));b=this.element.attr("id");a=a.children(T+G).eq(0);a.uniqueId();
f=a.attr("id");c&&a.attr("aria-label",c);d&&a.attr("title",d);a.attr("aria-labelledby",f+" "+b);this._hoverable(a);this.Up(a);this.options.arrowPlacement===e&&this.NK()&&a.addClass(B);return a},fJ:function(){return this.zj.find(T+P)},PB:function(){return this.zj.find(T+A)},Yn:function(){return this.zj.children(T+R)},ZT:function(){var a=this.zj;this.Yn().css(v,p).css(ca,p);this.fJ().css(v,p).css(ca,p);a.css(this.kq(),p)},jT:function(b){this.ZT();var c=this.options,d=this.Lb(),h=c.maxItemsPerPage,q=
1>h,l=this.element,t=this.fJ();if(0>this.kx){var m=this.xW(c.currentItem),m=f(t[m]),n=m.children(T+A);n.css(k,p);a.Components.Vm(n[0]);this.kx=d?m.width():m.height()}m=d?l.width():l.height();c.arrowVisibility!==x&&c.arrowPlacement===e&&(l=l.children(T+E).eq(0),d=d?l.width():l.height(),m-=2*d);this.Nn=m;q||(d=Math.max(Math.floor(m/this.kx),1),d<h&&(h=d));h=q?Math.max(Math.floor(m/this.kx),1):h;q=m/h;t.css(v,q+aa).css(ca,q+aa);q=Math.ceil(t.length/h);n=this.Yn();d=!1;l=this.Pd;if(l.getPageCount()!=
q||this.Fq!=h||!n||1>n.length){d=!0;if(b)for(var u=0;u<t.length;u++)a.Components.Lg(t[u]);n&&0<n.length&&t.unwrap();for(u=0;u<t.length;u+=h)t.slice(u,u+h).wrapAll("\x3cdiv class\x3d'"+z+" "+R+"' style\x3d'"+k+": "+J+";' "+g+"\x3d'true'\x3e\x3c/div\x3e");if(b)for(u=0;u<t.length;u++)a.Components.gf(t[u])}n=this.Yn();n.css(v,m+aa).css(ca,m+aa);b=this.UH;this.zj.css(this.kq(),m);b&&b.css(this.kq(),m);b=0;if(c.currentItem||0===c.currentItem)b=this.HI(c.currentItem,h);l.getPageCount()!=q||this.Fq!=h||l.getPage()!=
b?l.setPage(b,{pageSize:h}):d&&(c=l.getPage(),this.WJ({previousPage:c,page:c}))},WJ:function(a){var b=a.page,c=a.previousPage;a=this.zj;var d=this.Yn(),e=this.Pd.Ja,g=0>c||c==b||this.Fq!=e;this.Fq=e;e=null;g||(e=f(d[c]));var h=this.Iw(),k=f(d[b]),q=k.is(u);q&&this.GM(k);var l=this.Qs;-1<c&&!g&&(l=!0,a.css(this.kq(),2*this.Nn),b<c&&q&&a.css(h,-this.Nn+aa),b>c?(e.addClass(N),k.addClass(D)):(e.addClass(X),k.addClass(O)));if(l){var m=this,t=this.Qs;t&&0>c&&d.filter(S).addClass(I);setTimeout(function(){m.KV(b,
c,g,t)},25)}else this.KV(b,c,g)},KV:function(a,b,e,g){var h=this.zj;e||(this.xT=!0,h.on("transitionend"+this.eventNamespace+" webkitTransitionEnd"+this.eventNamespace,this.Ak));e?this.zq():(e=this.Yn(),g&&d(e),-1<b?(g=a>b,b=f(e[b]),a=f(e[a]),b.addClass(I),a.addClass(I),g?(b.removeClass(N),a.removeClass(D),b.addClass(U),a.addClass(M)):(b.removeClass(X),a.removeClass(O),b.addClass(W),a.addClass(Z))):g&&(a=e.filter(S),c(a,"translate3d(0, 0, 0)")))},zq:function(){this.xT=!1;var b=this.zj,c=this.Iw();
b.off(this.eventNamespace).css(this.kq(),this.Nn).css(c,"0px");c=null;if(a.ud.UD(b[0])||this.yj&&a.ud.UD(this.yj[0])||this.Hk&&a.ud.UD(this.Hk[0]))c=document.activeElement;for(var b=this.Pd.getPage(),e=this.Yn(),g=0;g<e.length;g++)g!=b&&this.SX(f(e[g]));e.removeClass(I+" "+U+" "+M+" "+W+" "+Z);d(e);this.Wma();c&&f(c).is(u)&&(c=this.element,(e=a.ud.j3(e[b]))?a.ud.Ey(e):a.ud.Ey(c[0]));this.HI(this.options.currentItem)!=b&&(b=this.nW(b),-1!==b&&this.option(C,b,{_context:{Hc:!0}}))},xW:function(b){var c=
-1,d=this.PB();if("number"===typeof b)0<=b&&b<d.length&&(c=b);else if("string"===typeof b&&a.v.vE(b))for(var e=0;e<d.length;e++){var f=d[e].id;if(f&&0<f.length&&f===b){c=e;break}}return c},HI:function(a,b){var c=this.xW(a),d=-1;-1<c&&(void 0===b&&(b=this.Fq),d=Math.floor(c/b));return d},nW:function(a,b,c){var d=this.Pd;void 0===b&&(b=d.getPageCount());return 0<=a&&a<b&&(b=this.PB(),void 0===c&&(c=this.Fq),a*=c,a<b.length)?(c=b[a].id)&&0<c.length?c:a:-1},SX:function(b){a.Components.jp(b[0]);b.css(k,
J).attr(g,"true");b.find(T+A).css(k,J)},GM:function(b){b.css(k,p).removeAttr(g);b.find(T+A).css(k,p);a.Components.Vm(b[0])},J$:function(){this.element.on("keydown"+this.p4,this.AX)},qka:function(){this.element.off(this.p4)},L$:function(){this.element.on("mousedown"+this.DE,this.BX).on("mousemove"+this.DE,this.CX).on("mouseup"+this.DE,this.EX)},ska:function(){this.element.off(this.DE)},P$:function(){this.element.on("touchstart"+this.rz,this.MX).on("touchmove"+this.rz,this.LX).on("touchend"+this.rz,
this.cK).on("touchcancel"+this.rz,this.cK)},zka:function(){this.element.off(this.rz)},xq:function(a){var b=this.Pd,c=b.getPage(),d=-1;switch(a.keyCode){case f.ui.keyCode.RIGHT:d=this.Cf?c-1:c+1;break;case f.ui.keyCode.LEFT:d=this.Cf?c+1:c-1;break;case f.ui.keyCode.DOWN:d=c+1;break;case f.ui.keyCode.UP:d=c-1;break;case f.ui.keyCode.HOME:d=0;break;case f.ui.keyCode.END:d=b.getPageCount()-1;break;default:return}-1<d&&d<b.getPageCount()&&b.setPage(d);a.preventDefault()},gga:function(a){this.uV(a.originalEvent)},
hga:function(a){this.tV(a,a.originalEvent)},jga:function(){this.sV()},eK:function(a){a=a.originalEvent.touches;1===a.length&&this.uV(a[0])},dK:function(a){this.tV(a,a.originalEvent.touches[0]);(this.si||this.Rq)&&a.preventDefault()},bK:function(){this.sV()},uV:function(a){if(1<this.Pd.getPageCount()&&!this.xT){this.si=!0;this.Qs=!1;var b=this.Lb();this.vD=b?a.pageX:a.pageY;this.t1=b?a.pageY:a.pageX}},Vga:function(a){var b=this.Lb();this.vD=b?a.pageX:a.pageY;this.t1=b?a.pageY:a.pageX;a=this.Iw();var b=
this.zj,c=this.Pd,d=this.Yn(),e=1;0<c.getPage()&&(this.GM(f(d[c.getPage()-1])),b.css(a,-this.Nn+aa),e++);c.getPage()<c.getPageCount()-1&&(this.GM(f(d[c.getPage()+1])),e++);1<e&&b.css(this.kq(),e*this.Nn);this.qM=parseInt(b.css(a),10)},tV:function(a,b){if(this.si){var d=this.Lb(),e=(d?b.pageX:b.pageY)-this.vD;Math.abs((d?b.pageY:b.pageX)-this.t1)>Math.abs(e)&&(this.Rq=this.si=!1);if(this.Qs){var g=d&&this.Cf?0<e:0>e,h=this.Pd,k=h.getPage();if(g&&k<h.getPageCount()-1||!g&&0<k){var q=this.element[0],
t=Math.min(m*(d?q.offsetWidth:q.offsetHeight),n),v=this.Iw(),p=this.zj,q=this.Yn();Math.abs(e)>=t?(d=g?k+1:k-1,this.nW(d),k=g?k-1:k+1,-1<k&&k<h.getPageCount()&&this.SX(f(q[k])),g&&-1<k&&(q=parseInt(p.css(v),10),p.css(v,q+this.Nn+aa)),p.css(this.kq(),2*this.Nn),this.si=!1,h.setPage(d)):(h=d&&this.Cf?-e:e,h=d?"translate3d("+h+"px, 0, 0)":"translate3d(0, "+h+"px, 0)",c(q.filter(S),h));this.Rq=!0}this.Rq&&(a.preventDefault(),a.stopPropagation())}else Math.abs(e)>l&&(this.Vga(b),this.Qs=!0)}},sV:function(){if(this.si&&
this.Qs){var a=this.Pd.getPage();this.WJ({previousPage:a,page:a})}this.Rq=this.Qs=this.si=!1},getNodeBySubId:function(a){if(null==a)return this.element?this.element[0]:null;a=a.subId;return"oj-filmstrip-start-arrow"===a?this.widget().find(T+G+T+V)[0]:"oj-filmstrip-end-arrow"===a?this.widget().find(T+G+T+F)[0]:"oj-filmstrip-top-arrow"===a?this.widget().find(T+G+T+ga)[0]:"oj-filmstrip-bottom-arrow"===a?this.widget().find(T+G+T+H)[0]:null},getSubIdByNode:function(a){for(var b=this.getNodeBySubId({subId:"oj-filmstrip-start-arrow"}),
c=this.getNodeBySubId({subId:"oj-filmstrip-end-arrow"}),d=this.getNodeBySubId({subId:"oj-filmstrip-top-arrow"}),e=this.getNodeBySubId({subId:"oj-filmstrip-bottom-arrow"}),f=this.element[0];a&&a!=f;){if(a===b)return{subId:"oj-filmstrip-start-arrow"};if(a===c)return{subId:"oj-filmstrip-end-arrow"};if(a===d)return{subId:"oj-filmstrip-top-arrow"};if(a===e)return{subId:"oj-filmstrip-bottom-arrow"};a=a.parentElement}return null}});var e="adjacent",g="aria-hidden",h="auto",k="display",l=3,m=.33,n=100,p=
"",r="JET FilmStrip: Value of 'currentItem' option not found: ",s="JET FilmStrip: Unsupported value set as 'orientation' option: ",q="Unsupported value set as 'arrowPlacement' option: ",t="Unsupported value set as 'arrowVisibility' option: ",v="flex-basis",x="hidden",u=":hidden",w="horizontal",y="hover",C="currentItem",J="none",H="oj-bottom",F="oj-end",G="oj-filmstrip-arrow",E="oj-filmstrip-arrow-container",B="oj-filmstrip-arrow-transition",z="oj-filmstrip-container",L="oj-filmstrip-hover",A="oj-filmstrip-item",
P="oj-filmstrip-item-container",R="oj-filmstrip-page",K="oj-filmstrip-pages-container",I="oj-filmstrip-transition",D="oj-filmstrip-transition-next-newpage-from",N="oj-filmstrip-transition-next-oldpage-from",O="oj-filmstrip-transition-prev-newpage-from",X="oj-filmstrip-transition-prev-oldpage-from",M="oj-filmstrip-transition-next-newpage-to",U="oj-filmstrip-transition-next-oldpage-to",Z="oj-filmstrip-transition-prev-newpage-to",W="oj-filmstrip-transition-prev-oldpage-to",Q="oj-filmstrip-vertical",
V="oj-start",ga="oj-top",Y="overlay",T=".",aa="px",fa="vertical",ba="visible",S=":visible",ca="-webkit-flex-basis",da="JET FilmStrip: 'disabled' option not supported"})()});